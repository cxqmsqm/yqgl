(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-671bd002"],{1750:function(e,t,a){"use strict";a("c65d")},"1b62":function(e,t,a){"use strict";t["a"]={data:function(){return{pageNo:1,pageSize:10,layout:"total, sizes, prev, pager, next, jumper",pageSizes:[10,20,30,40],total:0,keyword:"",tableData:[],currentItem:{},showDialog:!1}},methods:{currentChange:function(e){this.pageNo=e,this.load()},sizeChange:function(e){this.pageSize=e,this.load()},handleSearch:function(){this.pageNo=1,this.load()}}}},"5d71":function(e,t,a){"use strict";a("a42c")},a0bd:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"farm_class"},[a("div",{staticClass:"tool_class"},[a("el-input",{staticStyle:{width:"250px","margin-right":"20px"},attrs:{placeholder:"请输入关键字",border:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("添加")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"farmName",label:"养殖场名称"}}),a("el-table-column",{attrs:{prop:"adminName",label:"管理员姓名"}}),a("el-table-column",{attrs:{prop:"bossName",label:"法人姓名"}}),a("el-table-column",{attrs:{prop:"area",label:"地区"}}),a("el-table-column",{attrs:{prop:"bossCard",label:"法人身份证"}}),a("el-table-column",{attrs:{label:"养殖场资格证"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.certification}})]}}])}),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("time")(a.createDate))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.edit(r)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{layout:e.layout,"current-page":e.pageNo,"page-size":e.pageSize,"page-sizes":e.pageSizes,total:e.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange}}),a("add-edit-farm",{attrs:{farm:e.currentItem},on:{complete:e.handleComplete},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}})],1)},n=[],s=a("60b5"),i=(a("6a61"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{attrs:{title:e.title,"custom-class":"drawer_class",visible:e.value},on:{open:e.open,close:e.close}},[a("el-form",{ref:"form",attrs:{model:e.farm,"label-position":"left","label-width":"110px",rules:e.rules}},[a("el-form-item",{attrs:{label:"养殖场名称",prop:"farmName"}},[a("el-input",{model:{value:e.farm.farmName,callback:function(t){e.$set(e.farm,"farmName",t)},expression:"farm.farmName"}})],1),1===e.$store.state.user.userObject.isAdmin?a("el-form-item",{attrs:{label:"管理员名称",prop:"adminName"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",placeholder:"请输入管理员名称","remote-method":e.selectUserList,loading:e.loading,"automatic-dropdown":""},on:{change:e.adminChange},model:{value:e.farm.adminId,callback:function(t){e.$set(e.farm,"adminId",t)},expression:"farm.adminId"}},e._l(e.adminList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.realName,value:e.id}})})),1)],1):e._e(),a("el-form-item",{attrs:{label:"法人名称",prop:"bossName"}},[a("el-input",{model:{value:e.farm.bossName,callback:function(t){e.$set(e.farm,"bossName",t)},expression:"farm.bossName"}})],1),a("el-form-item",{attrs:{label:"法人身份证",prop:"bossCard"}},[a("el-input",{model:{value:e.farm.bossCard,callback:function(t){e.$set(e.farm,"bossCard",t)},expression:"farm.bossCard"}})],1),a("el-form-item",{attrs:{label:"地区",prop:"area"}},[a("el-select",{attrs:{placeholder:"请选择地区"},model:{value:e.farm.area,callback:function(t){e.$set(e.farm,"area",t)},expression:"farm.area"}},e._l(e.areas,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"养殖场资格证",prop:"certification"}},[a("el-upload",{attrs:{action:e.uploadUrl,"on-success":e.uploadSuccess,accept:".jpg,.jpeg,.gif,.png","show-file-list":!1}},[a("el-button",{attrs:{type:"primary",size:"small"}},[e._v("选取文件")])],1),e.farm.certification?a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.farm.certification}}):e._e()],1)],1),a("span",[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.ok}},[e._v("确 定")])],1)],1)}),o=[],l=(a("b911"),a("7065")),c=a.n(l),u=c.a.pro,m="".concat(u,"/uploadFile"),d=a("c24f"),f={name:"AddEditFarm",props:{value:{type:Boolean,default:!1},farm:{type:Object,default:function(){}}},computed:{uploadUrl:function(){return m},title:function(){return this.farm.id?"编辑养殖场":"添加养殖场"}},watch:{},data:function(){return{areas:["邗江区","广陵区","江都区","仪征市","高邮市","宝应县"],rules:{farmName:[{required:!0,message:"请输入养殖场名称",trigger:"blur"}],adminName:[{required:!0,message:"请输入管理员名称",trigger:"blur"}],bossName:[{required:!0,message:"请输入法人名称",trigger:"blur"}],area:[{required:!0,message:"请选择地区",trigger:"blur"}],bossCard:[{required:!0,message:"请输入法人身份证",trigger:"blur"}],certification:[{required:!0,message:"请上传养殖场资格证",trigger:"change"}]},adminList:[],loading:!1}},methods:{adminChange:function(e){var t=this.adminList.find((function(t){return t.id===e}));this.farm.adminName=t.realName},selectUserList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,r={pageNo:1,pageSize:0,keyword:e},a.next=4,Object(d["g"])(r);case 4:n=a.sent,s=n.data,t.adminList=s,t.loading=!1;case 8:case"end":return a.stop()}}),a)})))()},uploadSuccess:function(e){0===e.code?(this.farm.certification=e.data,this.$message.success("上传成功")):this.$message.error("上传失败")},close:function(){this.$refs.form.clearValidate(),this.$emit("input",!1)},ok:function(){var e=this;this.$refs.form.validate((function(t){t&&(1!=e.$store.state.user.userObject.isAdmin&&(e.farm.adminName=e.$store.state.user.userObject.realName,e.farm.adminId=e.$store.state.user.userObject.id),e.$emit("complete",e.farm))}))},open:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={pageNo:1,pageSize:0,keyword:""},t.next=3,Object(d["g"])(a);case 3:r=t.sent,n=r.data,e.adminList=n;case 6:case"end":return t.stop()}}),t)})))()}}},p=f,b=(a("1750"),a("5d22")),g=Object(b["a"])(p,i,o,!1,null,null,null),h=g.exports,w=a("1b62"),v=a("d415"),k={name:"Farm",mixins:[w["a"]],props:{},components:{AddEditFarm:h},computed:{},watch:{},data:function(){return{}},methods:{handleDelete:function(e){var t=this;this.$confirm("确认删除该养殖场？","提示",{type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(v["b"])(e.id);case 2:r=a.sent,n=r.code,s=r.msg,0===n?(t.$message.success("删除成功"),t.load()):t.$message.error(s);case 6:case"end":return a.stop()}}),a)}))))},edit:function(e){this.currentItem=JSON.parse(JSON.stringify(e)),this.showDialog=!0},handleComplete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s,i,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.id){a.next=9;break}return a.next=3,Object(v["c"])(e);case 3:r=a.sent,n=r.code,s=r.msg,0===n?(t.$message.success("编辑成功"),t.load()):t.$message.error(s),a.next=15;break;case 9:return a.next=11,Object(v["a"])(e);case 11:i=a.sent,o=i.code,l=i.msg,0===o?(t.$message.success("添加成功"),t.load()):t.$message.error(l);case 15:t.showDialog=!1;case 16:case"end":return a.stop()}}),a)})))()},handleAdd:function(){this.currentItem={farmName:"",adminName:"",bossName:"",bossCard:"",certification:"",area:""},this.showDialog=!0},load:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=1!=e.$store.state.user.userObject.isAdmin?e.$store.state.user.userObject.id:"",t.next=3,Object(v["d"])(e.pageNo,e.pageSize,e.keyword,a);case 3:r=t.sent,n=r.data,s=r.count,e.tableData=n,e.total=s;case 8:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.load()}},y=k,x=(a("5d71"),Object(b["a"])(y,r,n,!1,null,"476c1166",null));t["default"]=x.exports},a42c:function(e,t,a){},b911:function(e,t,a){"use strict";var r=a("bde0"),n=a("9670").find,s=a("6859"),i="find",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),r({target:"Array",proto:!0,forced:o},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),s(i)},c65d:function(e,t,a){},d415:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var r=a("b775"),n=function(e,t,a,n){var s={pageNo:e,pageSize:t,keyword:a,adminId:n};return Object(r["a"])({url:"/farm/selectFarmList",method:"POST",data:s})},s=function(e){return Object(r["a"])({url:"/farm/editFarm",method:"POST",data:e})},i=function(e){return Object(r["a"])({url:"/farm/addFarm",method:"POST",data:e})},o=function(e){return Object(r["a"])({url:"/farm/deleteFarm/".concat(e),method:"POST"})}}}]);